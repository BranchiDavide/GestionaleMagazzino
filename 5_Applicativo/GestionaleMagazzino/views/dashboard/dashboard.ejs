<!doctype html>
<html>

<head>
  <title>Gestionale Magazzino - Dashboard</title>
  <%- include('../headers/header'); -%>
  <%- include('../headers/headerTablePage'); -%>
  <link rel="stylesheet" href="/css/dashboard.css">
</head>

<body className='snippet-body'>

  <body id="body-pd">
    <%- include('../_templates/navbar.ejs', {active: "dashboard"}); -%>
    <!--Container Main start-->
    <div class="height-100 bg-light">
      <div class="main-section">
        <div class="item-title">
          <h2>Benvenuto/a nella Dashboard <%= session.user.nome %></h2>
        </div>
        <div style="margin-bottom: 3.5rem; margin-top: 2.5rem;">
          <div class="dashboard-functions">
            <div class="subcontainer-row-dashboard">
              <a href="/noleggi/nuovo" class="function-button-link"><button style="height: 7.5rem; width: 100%; left: 0;"><i class='bx bx-message-alt-add nav_icon'></i><a style="text-decoration: none;">Nuovo noleggio</a></button></a>
            </div>
            <div class="subcontainer-row-dashboard" style="text-align: right;">
              <a href="/noleggi/nuovo" class="function-button-link"><button style="height: 7.5rem; width: 100%; left: 0;"><i class='bx bx-message-alt-add nav_icon'></i><a style="text-decoration: none;">Nuovo noleggio</a></button></a>
            </div>
          </div>
          <div class="dashboard-functions">
            <div class="subcontainer-row-dashboard">
              <a href="/noleggi/nuovo" class="function-button-link"><button style="height: 7.5rem; width: 100%; left: 0;"><i class='bx bx-message-alt-add nav_icon'></i><a style="text-decoration: none;">Nuovo noleggio</a></button></a>
            </div>
            <div class="subcontainer-row-dashboard" style="text-align: right;">
              <a href="/noleggi/nuovo" class="function-button-link"><button style="height: 7.5rem; width: 100%; left: 0;"><i class='bx bx-message-alt-add nav_icon'></i><a style="text-decoration: none;">Nuovo noleggio</a></button></a>
            </div>
          </div>
        </div>
        <br><br>
        <div class="item-title">
          <h2>I tuoi noleggi</h2>
        </div>
        <% if(session.displaySuccessMsg){ %>
          <div class="alert alert-success" role="alert">
            <%= session.displaySuccessMsg %>
            <% session.displaySuccessMsg = null %>
          </div>
        <% } %>
        <% if(session.displayErrorMsg){ %>
          <div class="alert alert-danger" role="alert">
            <%= session.displayErrorMsg %>
            <% session.displayErrorMsg = null %>
          </div>
        <% } %>
        <div class="container">
          <div class="custom-table-container">
            <table class="table custom-table searchable-table">
              <thead>
                <tr>
                  <th scope="col">Nome</th>
                  <th scope="col">Scadenza</th>
                  <th class="optional" scope="col">Autore</th>
                  <th scope="col">Mostra</th>
                </tr>
              </thead>
              <tbody>
                <% for (let item of noleggi) { %>
                    <tr>
                      <td><%= item.nome %></td>
                      <% 
                        let dataFine = new Date(item.dataFine);
                        let dataFineFormatted = dataFine.toLocaleDateString("en-CH");
                       %>
                      <td <% if(new Date() > dataFine){%>style="color: red;"<%}%>><%=dataFineFormatted %></td>
                      <td class="optional"><%=item.idUtente %></td>
                      <td><a href="/noleggi/<%= item.id %>"><button type="submit"><i class="bx bx-show-alt"></i></button></a></td>
                      </tr>
                <% } %>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
    <script src="/js/navbar.js"></script>
  </body>
</html>